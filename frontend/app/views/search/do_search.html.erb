<%
  title = "Search"
  title << " for \"#{params[:q]}\"" if params.has_key?(:q) and not params[:q].blank?

  if params.has_key?(:type) and not params[:type].blank?
    if params[:type].kind_of? String
      title << " in #{I18n.t("#{params[:type]}._plural")}"
    else # an array
      title << " in #{params[:type].map{|t| I18n.t("#{t}._plural")}.join(",")}"
    end
  end

  if @search_data.results? && @search_data['results'].any?{|result| ['digital_object', 'digital_object_component', 'archival_object'].include?(result['primary_type'])}
    add_column(
        "Thumbnail",
        proc {|record|
          json = ASUtils.json_parse(record['json'])
          if thumbnail_available?(json)
            render_aspace_partial(:partial => "digital_objects/thumbnail_for_file_version", :locals => {:file_version => fetch_thumbnail(json)})
          end
        },
        :sortable => false, :class => 'thumbnail-col'
    )
  end

%>

<%= setup_context :title => title %>

<%= render_aspace_partial :partial => "results" %>
